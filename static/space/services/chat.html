<!DOCTYPE html>
<script type=module>

import Observers from '../js/Observers.js';
import Service from '../js/Service.js';

class Chat {
  constructor() {
    this.observers = new Observers();
  }
}
const chat = new Chat();

class ChatClient {
  constructor(context) {
    this.context = context;
  }

  observe(key, cb) {
    return chat.observers.add(key, this.context, cb);
  }

  addMessage(message) {
    chat.observers.fire('message', message);
  }
}

const chatClientCb = context => new ChatClient(context);
Service.register('chat', chatClientCb);

</script>
